define("github-rollup-gist-bootstrap",["invariant","selector-observer","@github/query-selector","github/google-analytics","github/throttled-input","github/fetch-json","github/code-editor","delegated-events","github/onfocus","github/remote-form","github/navigation","github/sliding-promise-queue","github/fetch","github/form"],function(e,t,s,n,o,i,r,a,c,u,l,d,g,f){"use strict";function m(e){s.query(document,".js-gist-dropzone").classList.remove("d-none"),e.stopPropagation(),e.preventDefault()}function p(e){const t=e.target;t instanceof Element&&t.classList.contains("js-gist-dropzone")&&t.classList.add("d-none")}function h(e){!async function(e){const t=e.dataTransfer;if(t)for(const o of t.files){n.trackEvent({category:"Interaction",action:"File Drop",label:o.type});try{const t=await v(o);e.target.dispatchEvent(new CustomEvent("gist:filedrop",{bubbles:!0,detail:t}))}catch(s){}}}(e),s.query(document,".js-gist-dropzone").classList.add("d-none"),e.stopPropagation(),e.preventDefault()}function v(t){return new Promise(function(s,n){const o=new FileReader;o.onload=function(){e("string"==typeof o.result,"app/assets/modules/github/gist/drag-drop.js:74");const i=o.result;i&&!/\0/.test(i)?s({file:t,data:i}):n(new Error("invalid file"))},o.readAsText(t)})}function j(t){const n=s.query(t,".js-gist-files"),o=document.getElementById("js-gist-file-template");e(o,"app/assets/modules/github/gist/gist-edit.js:18");const i=document.createElement("div");i.innerHTML=o.textContent;for(const e of i.querySelectorAll("[id]"))e.removeAttribute("id");const r=i.querySelector(".js-code-textarea");null!=r&&r.setAttribute("id",`blob_contents_${Date.now()}`);for(const e of i.children)n.append(e);const a=n.lastElementChild;return e(a,"app/assets/modules/github/gist/gist-edit.js:37"),a}function b(e){return r.getAsyncCodeEditor(s.closest(e,".js-code-editor"))}function y(e){return s.querySelectorAll(e,".js-code-textarea",HTMLTextAreaElement).some(e=>e.value.trim().length>0)}function L(){for(const t of s.querySelectorAll(document,".js-gist-create",HTMLButtonElement)){const s=t.form;e(s,"app/assets/modules/github/gist/gist-edit.js:66"),t.disabled=!y(s)}}async function q(e){const t=e.getAttribute("data-language-detection-url");if(!t)return;const s=new URL(t,window.location.origin),n=new URLSearchParams(s.search.slice(1));n.append("filename",e.value),s.search=n.toString();const o=await i.fetchJSON(s);(await b(e)).setMode(o.language)}function E(e){const t=e.querySelectorAll(".js-remove-gist-file");for(const s of t)s.classList.toggle("d-none",t.length<2)}e=e&&e.hasOwnProperty("default")?e.default:e,d=d&&d.hasOwnProperty("default")?d.default:d,t.observe(".js-gist-dropzone",{add(){const t=document.body;e(t,"app/assets/modules/github/gist/drag-drop.js:53"),t.addEventListener("dragenter",m),t.addEventListener("dragleave",p),t.addEventListener("dragover",m),t.addEventListener("drop",h)},remove(){const t=document.body;e(t,"app/assets/modules/github/gist/drag-drop.js:61"),t.removeEventListener("dragenter",m),t.removeEventListener("dragleave",p),t.removeEventListener("dragover",m),t.removeEventListener("drop",h)}}),a.on("change",".js-code-textarea",function(){L()}),c.onFocus(".js-gist-filename",async t=>{const n=t;e(n instanceof HTMLInputElement,"app/assets/modules/github/gist/gist-edit.js:98");const i=s.closest(t,".js-code-editor");await b(i),o.addThrottledInputEventListener(n,q),t.addEventListener("blur",()=>o.removeThrottledInputEventListener(n,q),{once:!0})}),a.on("click",".js-add-gist-file",function(e){e.preventDefault(),j(s.closest(e.currentTarget,".js-blob-form")).scrollIntoView()}),a.on("gist:filedrop",".js-blob-form",async function(t){e(t instanceof CustomEvent,"app/assets/modules/github/gist/gist-edit.js:112");const n=t.detail,o=n.file,i=n.data,r=function(e){for(const t of e.querySelectorAll(".js-gist-file")){const e=s.query(t,".js-gist-filename",HTMLInputElement),n=s.query(t,".js-blob-contents",HTMLTextAreaElement);if(!e.value&&!n.value)return t}return j(e)}(t.currentTarget),a=s.query(r,".js-gist-filename",HTMLInputElement);a.value=o.name,q(a),(await b(a)).setCode(i),r.scrollIntoView()}),a.on("click",".js-remove-gist-file",function(e){e.preventDefault();const t=s.closest(e.currentTarget,".js-gist-file");for(const n of s.querySelectorAll(t,".js-gist-deleted input",HTMLInputElement))n.disabled=!1;s.query(t,".js-code-editor").remove()}),t.observe(".js-gist-create",L),t.observe(".js-remove-gist-file",function(e){const t=s.closest(e,".js-gist-files");return{add(){E(t)},remove(){E(t)}}}),a.on("details-menu-selected",".js-gist-share-menu",function(t){const n=t.currentTarget,o=t.target;e(o instanceof HTMLButtonElement,"app/assets/modules/github/gist/share.js:10"),s.query(n,"#gist-share-url",HTMLInputElement).value=o.value}),u.remoteForm(".js-gist-file-update-container .js-comment-update",async function(e,t){let n;try{n=await t.json()}catch(o){return}if(e.action=n.json.url,n.json.authenticity_token){s.query(e,"input[name=authenticity_token]",HTMLInputElement).value=n.json.authenticity_token}});const T=new d;c.onFocus(".js-quicksearch-field",function(t){e(t instanceof HTMLInputElement,"app/assets/modules/github/gist/quicksearch.js:50"),e(t.form,"app/assets/modules/github/gist/quicksearch.js:51"),l.push(s.query(t.form,".js-quicksearch-results"))}),c.onInput(".js-quicksearch-field",async function(t){const n=t.target;e(n instanceof HTMLInputElement,"app/assets/modules/github/gist/quicksearch.js:80");const o=n.value.replace(/^\s+|\s+$/g,""),i=s.closest(n,"form"),r=s.query(i,".js-quicksearch-results"),a=s.getAttribute(r,"data-quicksearch-url");let c,u;if(o.length){const e=new URL(a,window.location.origin),t=new URLSearchParams(e.search.slice(1));t.append("q",o),e.search=t.toString(),i.classList.add("is-sending"),c=g.fetchText(e)}else c=Promise.resolve("");try{u=await T.push(c)}finally{u&&(r.innerHTML=u),r.classList.toggle("active",""!==o),i.classList.remove("is-sending")}}),a.on("navigation:keydown",".js-quicksearch-results",function(t){e(t instanceof CustomEvent,"app/assets/modules/github/gist/quicksearch.js:65");const n=t.target,o=s.closest(n,"form",HTMLFormElement);if("Escape"===t.detail.hotkey){const e=s.query(o,".js-quicksearch-results");e.classList.remove("active"),l.clear(e)}else"Enter"!==t.detail.hotkey||n.classList.contains("js-navigation-item")||(f.submit(o),t.preventDefault())}),a.on("submit",".js-quicksearch-form",function(t){e(t.currentTarget instanceof HTMLFormElement,"app/assets/modules/github/gist/quicksearch.js:56");const s=t.currentTarget.querySelector(".js-quicksearch-results");s&&(s.classList.remove("active"),l.pop(s))}),a.on("focusout:delay",".js-quicksearch-field",function(e){const t=s.closest(e.currentTarget,"form",HTMLFormElement).querySelector(".js-quicksearch-results");t&&(t.classList.remove("active"),l.pop(t))})});

//# sourceMappingURL=gist-daaa4577103a7320cfdc0524d0c4cd8b.js.map
